{"version":3,"file":"simplePollingAction.js","sources":["../src/PollingAction/index.ts"],"sourcesContent":["/**\n * @class SimplePollingAction\n * @param {Function}  callback[回调函数]\n * @param {Number}  time[轮询时间]\n * @param {immediate}  immediate[是否立即执行回调函数]\n * @description  通过给定的TIME进行轮询操作\n */\nexport default class SimplePollingAction {\n  running: boolean;\n  immediate: boolean;\n  timer: any;\n  time: number;\n  callback: (() => void) | null;\n  constructor(callback: () => void, time: number = 1000, immediate: boolean = false) {\n    // 执行状态\n    this.running = false;\n    // 轮询间隔\n    this.time = time;\n    // 是否立即执行\n    this.immediate = immediate;\n    // callback判断\n    if (callback) {\n      if (typeof callback === 'function') {\n        this.callback = callback;\n      } else {\n        throw new Error('参数1 必须是个函数');\n      }\n    } else {\n      this.callback = null;\n    }\n    // timer控制\n    this.timer = null;\n  }\n\n  // 执行轮询\n  start() {\n    // 是否立即执行\n    this.immediate && this.callback && this.callback();\n    this.running = true;\n    const onAction = () => {\n      this.timer = setTimeout(() => {\n        if (this.running) {\n          this.callback && this.callback();\n          return onAction();\n        }\n        return null;\n      }, this.time);\n    };\n    onAction();\n    return this;\n  }\n\n  // 取消轮询\n  cancel() {\n    this.running = false;\n    this.timer && clearTimeout(this.timer);\n    this.timer = null;\n  }\n}\n"],"names":[],"mappings":";;;;;;EAAA;;;;;;;EAOA;MAME,6BAAY,QAAoB,EAAE,IAAmB,EAAE,SAA0B;UAA/C,qBAAA,EAAA,WAAmB;UAAE,0BAAA,EAAA,iBAA0B;;UAE/E,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;;UAErB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;;UAEjB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;;UAE3B,IAAI,QAAQ,EAAE;cACZ,IAAI,OAAO,QAAQ,KAAK,UAAU,EAAE;kBAClC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;eAC1B;mBAAM;kBACL,MAAM,IAAI,KAAK,CAAC,YAAY,CAAC,CAAC;eAC/B;WACF;eAAM;cACL,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;WACtB;;UAED,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;OACnB;;MAGD,mCAAK,GAAL;UAAA,iBAeC;;UAbC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,EAAE,CAAC;UACnD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;UACpB,IAAM,QAAQ,GAAG;cACf,KAAI,CAAC,KAAK,GAAG,UAAU,CAAC;kBACtB,IAAI,KAAI,CAAC,OAAO,EAAE;sBAChB,KAAI,CAAC,QAAQ,IAAI,KAAI,CAAC,QAAQ,EAAE,CAAC;sBACjC,OAAO,QAAQ,EAAE,CAAC;mBACnB;kBACD,OAAO,IAAI,CAAC;eACb,EAAE,KAAI,CAAC,IAAI,CAAC,CAAC;WACf,CAAC;UACF,QAAQ,EAAE,CAAC;UACX,OAAO,IAAI,CAAC;OACb;;MAGD,oCAAM,GAAN;UACE,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;UACrB,IAAI,CAAC,KAAK,IAAI,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;UACvC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;OACnB;MACH,0BAAC;EAAD,CAAC,IAAA;;;;;;;;"}